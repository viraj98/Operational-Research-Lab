clc;
% ---  SONAR Energy Problem  ---
% ---    Decision Variable   --- 
% xij = Quantity taken from ith Supplier and Transported to jth Place
% where i = 1,2....7 and j = 1,2...5.
%
% Objective function, Min Z =   5x11+5x12+4.75x13+5x14+4.75x15
%                               3.75x21+................3.5x25
%                               . . . . . . . . . . . . . . .
%                               2x71+2x72...............1.6x75
%                               32*(x41+x42+x43+x44+x45)
%                               35*(x51+x52+x53+x54+x55)  
%                               31*(x61+x62+x63+x64+x65)
%                               33*(x71+x72+x73+x74+x75)
%% --- Constraints -----%%
% -- Supplier Constraint --
% x11+x12+x13+x14+x15=350000
% x21+x22+x23+x24+x25=300000
% x31+x32+x33+x34+x35=275000
% x41+x42+x43+x44+x45<=200000
% x51+x52+x53+x54+x55<=175000
% x61+x62+x63+x64+x65<=200000
% x71+x72+x73+x74+x75<=180000
% -- Production Constraint --
% 13000x11+13300x21+12600x31+12250x41+12000x51+12000x61+11300x71 >= (550000*10.5)*1000
% 13000x12+13300x22+12600x32+12250x42+12000x52+12000x62+11300x72 >= (500000*10.2)*1000
% 13000x13+13300x23+12600x33+12250x43+12000x53+12000x63+11300x73 >= (650000*10.1)*1000
% 13000x14+13300x24+12600x34+12250x44+12000x54+12000x64+11300x74 >= (750000*10)*1000
% 13000x15+13300x25+12600x35+12250x45+12000x55+12000x65+11300x75 >= (1100000*10)*1000
%% -------------------------------------------------------------------------------------%%
C = [5 5 4.75 5 4.75 3.75 3.75 3.5 3.75 3.5 3 3 2.75 3 2.75 35.25 35.25 34.85 35.25 34.85 40 40 39.75 40 39.75 33.25 33.25 33 33.25 33 35 35 34.6 35 34.6];
A = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 0 0 0 0 0;
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1;
     -13000 0 0 0 0 -13300 0 0 0 0 -12600 0 0 0 0 -12250 0 0 0 0 -12000 0 0 0 0 -12000 0 0 0 0 -11300 0 0 0 0;
     0 -13000 0 0 0 0 -13300 0 0 0 0 -12600 0 0 0 0 -12250 0 0 0 0 -12000 0 0 0 0 -12000 0 0 0 0 -11300 0 0 0;
     0 0 -13000 0 0 0 0 -13300 0 0 0 0 -12600 0 0 0 0 -12250 0 0 0 0 -12000 0 0 0 0 -12000 0 0 0 0 -11300 0 0;
     0 0 0 -13000 0 0 0 0 -13300 0 0 0 0 -12600 0 0 0 0 -12250 0 0 0 0 -12000 0 0 0 0 -12000 0 0 0 0 -11300 0;
     0 0 0 0 -13000 0 0 0 0 -13300 0 0 0 0 -12600 0 0 0 0 -12250 0 0 0 0 -12000 0 0 0 0 -12000 0 0 0 0 -11300];
Aeq = [1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
        0 0 0 0 0 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
        0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

 b = 10000*[20;17.5;20;18;-55*10500;-50*10200;-65*10100;-75*10000;-110*10000];

beq = [350000;300000;275000];

lb = [0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0];
ub = 100000*[3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5];
%intcon=1:35;
%[x,fval] = intlinprog(C,intcon,A,b,Aeq,beq,lb);
[x,fval] = linprog(C,A,b,Aeq,beq,lb,ub);

d = [5 5 4.75 5 4.75 3.75 3.75 3.5 3.75 3.5 3 3 2.75 3 2.75 3.25 3.25 2.85 3.25 2.85 5 5 4.75 5 4.75 2.25 2.25 2 2.25 2 2 2 1.6 2 1.6];
e = [22 22 22 22 22 26 26 26 26 26 22 22 22 22 22 32 32 32 32 32 35 35 35 35 35 31 31 31 31 31 33 33 33 33 33];
a1 = [22+5 0 0 0 0 26+3.75 0 0 0 0 22+3 0 0 0 0 32+3.25 0 0 0 0 35+5 0 0 0 0 31+2.25 0 0 0 0 33+2 0 0 0 0];
a2 = [0 22+5 0 0 0 0 26+3.75 0 0 0 0 22+3 0 0 0 0 32+3.25 0 0 0 0 35+5 0 0 0 0 31+2.25 0 0 0 0 33+2 0 0 0];
a3 = [0 0 22+4.75 0 0 0 0 26+3.5 0 0 0 0 22+2.75 0 0 0 0 32+3.85 0 0 0 0 35+4.75 0 0 0 0 31+2 0 0 0 0 33+1.6 0 0];
a4 = [0 0 0 22+5 0 0 0 0 26+3.75 0 0 0 0 22+3 0 0 0 0 32+3.25 0 0 0 0 35+5 0 0 0 0 31+2.25 0 0 0 0 33+2 0];
a5 = [0 0 0 0 22+4.75 0 0 0 0 26+3.5 0 0 0 0 22+2.75 0 0 0 0 32+3.85 0 0 0 0 35+4.75 0 0 0 0 31+2 0 0 0 0 33+1.6];
k1 = [13000 0 0 0 0 13300 0 0 0 0 12600 0 0 0 0 12250 0 0 0 0 12000 0 0 0 0 12000 0 0 0 0 11300 0 0 0 0];
k2 = [0 13000 0 0 0 0 13300 0 0 0 0 12600 0 0 0 0 12250 0 0 0 0 12000 0 0 0 0 12000 0 0 0 0 11300 0 0 0];
k3 = [0 0 13000 0 0 0 0 13300 0 0 0 0 12600 0 0 0 0 12250 0 0 0 0 12000 0 0 0 0 12000 0 0 0 0 11300 0 0];
k4 = [0 0 0 13000 0 0 0 0 13300 0 0 0 0 12600 0 0 0 0 12250 0 0 0 0 12000 0 0 0 0 12000 0 0 0 0 11300 0];
k5 = [0 0 0 0 13000 0 0 0 0 13300 0 0 0 0 12600 0 0 0 0 12250 0 0 0 0 12000 0 0 0 0 12000 0 0 0 0 11300];
z1 = [1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0];
z2 = [0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0];
z3 = [0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0];
z4 = [0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0];
z5 = [0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1];
fprintf('\nQuestion 1\n');
%fprintf('Total Cost: %d\n',(fval+21550000));
fprintf('Total Purchase Cost: %d\n',dot(e,x));
fprintf('Total Delivery Cost: %d\n\n',dot(d,x));
for i=1:7
    s(i) = 0;
end
for i=1:7
    for j=1:5
        s(i)=s(i)+x((i-1)*5+j);
    end
end
for i=1:7
    fprintf('Coal Purchase from supplier %d(in Tons): %d\n',i,s(i));
end

fprintf('\nQuestion 2\n');
fprintf('Average Cost of coal per million BTUs for generating units\n');
fprintf('24Pargana E : %d\n',(dot(a1,x)*1000000/10500));
fprintf('24Pargana W : %d\n',(dot(a2,x)*1000000/10200));
fprintf('  Paradip   : %d\n',(dot(a3,x)*1000000/10100));
fprintf('  Durgapur  : %d\n',(dot(a4,x)*1000000/10000));
fprintf(' Darjeeling : %d\n',(dot(a5,x)*1000000/10000));

fprintf('\nQuestion 3\n');
fprintf('Average Number of BTUs per ton of coal received at generating unit\n');
fprintf('24Pargana E : %d\n',(dot(k1,x)/(dot(z1,x))));
fprintf('24Pargana W : %d\n',(dot(k2,x)/(dot(z2,x))));
fprintf('  Paradip   : %d\n',(dot(k3,x)/(dot(z3,x))));
fprintf('  Durgapur  : %d\n',(dot(k4,x)/(dot(z4,x))));
fprintf(' Darjeeling : %d\n',(dot(k5,x)/(dot(z5,x))));